<!DOCTYPE html>
    <html>
    <head>
        <meta charset="UTF-8">
        <title>General info</title>
        <style>
/* From extension vscode.markdown-math */
@font-face{font-family:KaTeX_AMS;src:url(fonts/KaTeX_AMS-Regular.woff2) format("woff2"),url(fonts/KaTeX_AMS-Regular.woff) format("woff"),url(fonts/KaTeX_AMS-Regular.ttf) format("truetype");font-weight:400;font-style:normal}@font-face{font-family:KaTeX_Caligraphic;src:url(fonts/KaTeX_Caligraphic-Bold.woff2) format("woff2"),url(fonts/KaTeX_Caligraphic-Bold.woff) format("woff"),url(fonts/KaTeX_Caligraphic-Bold.ttf) format("truetype");font-weight:700;font-style:normal}@font-face{font-family:KaTeX_Caligraphic;src:url(fonts/KaTeX_Caligraphic-Regular.woff2) format("woff2"),url(fonts/KaTeX_Caligraphic-Regular.woff) format("woff"),url(fonts/KaTeX_Caligraphic-Regular.ttf) format("truetype");font-weight:400;font-style:normal}@font-face{font-family:KaTeX_Fraktur;src:url(fonts/KaTeX_Fraktur-Bold.woff2) format("woff2"),url(fonts/KaTeX_Fraktur-Bold.woff) format("woff"),url(fonts/KaTeX_Fraktur-Bold.ttf) format("truetype");font-weight:700;font-style:normal}@font-face{font-family:KaTeX_Fraktur;src:url(fonts/KaTeX_Fraktur-Regular.woff2) format("woff2"),url(fonts/KaTeX_Fraktur-Regular.woff) format("woff"),url(fonts/KaTeX_Fraktur-Regular.ttf) format("truetype");font-weight:400;font-style:normal}@font-face{font-family:KaTeX_Main;src:url(fonts/KaTeX_Main-Bold.woff2) format("woff2"),url(fonts/KaTeX_Main-Bold.woff) format("woff"),url(fonts/KaTeX_Main-Bold.ttf) format("truetype");font-weight:700;font-style:normal}@font-face{font-family:KaTeX_Main;src:url(fonts/KaTeX_Main-BoldItalic.woff2) format("woff2"),url(fonts/KaTeX_Main-BoldItalic.woff) format("woff"),url(fonts/KaTeX_Main-BoldItalic.ttf) format("truetype");font-weight:700;font-style:italic}@font-face{font-family:KaTeX_Main;src:url(fonts/KaTeX_Main-Italic.woff2) format("woff2"),url(fonts/KaTeX_Main-Italic.woff) format("woff"),url(fonts/KaTeX_Main-Italic.ttf) format("truetype");font-weight:400;font-style:italic}@font-face{font-family:KaTeX_Main;src:url(fonts/KaTeX_Main-Regular.woff2) format("woff2"),url(fonts/KaTeX_Main-Regular.woff) format("woff"),url(fonts/KaTeX_Main-Regular.ttf) format("truetype");font-weight:400;font-style:normal}@font-face{font-family:KaTeX_Math;src:url(fonts/KaTeX_Math-BoldItalic.woff2) format("woff2"),url(fonts/KaTeX_Math-BoldItalic.woff) format("woff"),url(fonts/KaTeX_Math-BoldItalic.ttf) format("truetype");font-weight:700;font-style:italic}@font-face{font-family:KaTeX_Math;src:url(fonts/KaTeX_Math-Italic.woff2) format("woff2"),url(fonts/KaTeX_Math-Italic.woff) format("woff"),url(fonts/KaTeX_Math-Italic.ttf) format("truetype");font-weight:400;font-style:italic}@font-face{font-family:"KaTeX_SansSerif";src:url(fonts/KaTeX_SansSerif-Bold.woff2) format("woff2"),url(fonts/KaTeX_SansSerif-Bold.woff) format("woff"),url(fonts/KaTeX_SansSerif-Bold.ttf) format("truetype");font-weight:700;font-style:normal}@font-face{font-family:"KaTeX_SansSerif";src:url(fonts/KaTeX_SansSerif-Italic.woff2) format("woff2"),url(fonts/KaTeX_SansSerif-Italic.woff) format("woff"),url(fonts/KaTeX_SansSerif-Italic.ttf) format("truetype");font-weight:400;font-style:italic}@font-face{font-family:"KaTeX_SansSerif";src:url(fonts/KaTeX_SansSerif-Regular.woff2) format("woff2"),url(fonts/KaTeX_SansSerif-Regular.woff) format("woff"),url(fonts/KaTeX_SansSerif-Regular.ttf) format("truetype");font-weight:400;font-style:normal}@font-face{font-family:KaTeX_Script;src:url(fonts/KaTeX_Script-Regular.woff2) format("woff2"),url(fonts/KaTeX_Script-Regular.woff) format("woff"),url(fonts/KaTeX_Script-Regular.ttf) format("truetype");font-weight:400;font-style:normal}@font-face{font-family:KaTeX_Size1;src:url(fonts/KaTeX_Size1-Regular.woff2) format("woff2"),url(fonts/KaTeX_Size1-Regular.woff) format("woff"),url(fonts/KaTeX_Size1-Regular.ttf) format("truetype");font-weight:400;font-style:normal}@font-face{font-family:KaTeX_Size2;src:url(fonts/KaTeX_Size2-Regular.woff2) format("woff2"),url(fonts/KaTeX_Size2-Regular.woff) format("woff"),url(fonts/KaTeX_Size2-Regular.ttf) format("truetype");font-weight:400;font-style:normal}@font-face{font-family:KaTeX_Size3;src:url(fonts/KaTeX_Size3-Regular.woff2) format("woff2"),url(fonts/KaTeX_Size3-Regular.woff) format("woff"),url(fonts/KaTeX_Size3-Regular.ttf) format("truetype");font-weight:400;font-style:normal}@font-face{font-family:KaTeX_Size4;src:url(fonts/KaTeX_Size4-Regular.woff2) format("woff2"),url(fonts/KaTeX_Size4-Regular.woff) format("woff"),url(fonts/KaTeX_Size4-Regular.ttf) format("truetype");font-weight:400;font-style:normal}@font-face{font-family:KaTeX_Typewriter;src:url(fonts/KaTeX_Typewriter-Regular.woff2) format("woff2"),url(fonts/KaTeX_Typewriter-Regular.woff) format("woff"),url(fonts/KaTeX_Typewriter-Regular.ttf) format("truetype");font-weight:400;font-style:normal}.katex{font:normal 1.21em KaTeX_Main,Times New Roman,serif;line-height:1.2;text-indent:0;text-rendering:auto;border-color:currentColor}.katex *{-ms-high-contrast-adjust:none!important}.katex .katex-version:after{content:"0.13.0"}.katex .katex-mathml{position:absolute;clip:rect(1px,1px,1px,1px);padding:0;border:0;height:1px;width:1px;overflow:hidden}.katex .katex-html>.newline{display:block}.katex .base{position:relative;white-space:nowrap;width:-webkit-min-content;width:-moz-min-content;width:min-content}.katex .base,.katex .strut{display:inline-block}.katex .textbf{font-weight:700}.katex .textit{font-style:italic}.katex .textrm{font-family:KaTeX_Main}.katex .textsf{font-family:KaTeX_SansSerif}.katex .texttt{font-family:KaTeX_Typewriter}.katex .mathnormal{font-family:KaTeX_Math;font-style:italic}.katex .mathit{font-family:KaTeX_Main;font-style:italic}.katex .mathrm{font-style:normal}.katex .mathbf{font-family:KaTeX_Main;font-weight:700}.katex .boldsymbol{font-family:KaTeX_Math;font-weight:700;font-style:italic}.katex .amsrm,.katex .mathbb,.katex .textbb{font-family:KaTeX_AMS}.katex .mathcal{font-family:KaTeX_Caligraphic}.katex .mathfrak,.katex .textfrak{font-family:KaTeX_Fraktur}.katex .mathtt{font-family:KaTeX_Typewriter}.katex .mathscr,.katex .textscr{font-family:KaTeX_Script}.katex .mathsf,.katex .textsf{font-family:KaTeX_SansSerif}.katex .mathboldsf,.katex .textboldsf{font-family:KaTeX_SansSerif;font-weight:700}.katex .mathitsf,.katex .textitsf{font-family:KaTeX_SansSerif;font-style:italic}.katex .mainrm{font-family:KaTeX_Main;font-style:normal}.katex .vlist-t{display:inline-table;table-layout:fixed;border-collapse:collapse}.katex .vlist-r{display:table-row}.katex .vlist{display:table-cell;vertical-align:bottom;position:relative}.katex .vlist>span{display:block;height:0;position:relative}.katex .vlist>span>span{display:inline-block}.katex .vlist>span>.pstrut{overflow:hidden;width:0}.katex .vlist-t2{margin-right:-2px}.katex .vlist-s{display:table-cell;vertical-align:bottom;font-size:1px;width:2px;min-width:2px}.katex .vbox{display:inline-flex;flex-direction:column;align-items:baseline}.katex .hbox{width:100%}.katex .hbox,.katex .thinbox{display:inline-flex;flex-direction:row}.katex .thinbox{width:0;max-width:0}.katex .msupsub{text-align:left}.katex .mfrac>span>span{text-align:center}.katex .mfrac .frac-line{display:inline-block;width:100%;border-bottom-style:solid}.katex .hdashline,.katex .hline,.katex .mfrac .frac-line,.katex .overline .overline-line,.katex .rule,.katex .underline .underline-line{min-height:1px}.katex .mspace{display:inline-block}.katex .clap,.katex .llap,.katex .rlap{width:0;position:relative}.katex .clap>.inner,.katex .llap>.inner,.katex .rlap>.inner{position:absolute}.katex .clap>.fix,.katex .llap>.fix,.katex .rlap>.fix{display:inline-block}.katex .llap>.inner{right:0}.katex .clap>.inner,.katex .rlap>.inner{left:0}.katex .clap>.inner>span{margin-left:-50%;margin-right:50%}.katex .rule{display:inline-block;border:0 solid;position:relative}.katex .hline,.katex .overline .overline-line,.katex .underline .underline-line{display:inline-block;width:100%;border-bottom-style:solid}.katex .hdashline{display:inline-block;width:100%;border-bottom-style:dashed}.katex .sqrt>.root{margin-left:.27777778em;margin-right:-.55555556em}.katex .fontsize-ensurer.reset-size1.size1,.katex .sizing.reset-size1.size1{font-size:1em}.katex .fontsize-ensurer.reset-size1.size2,.katex .sizing.reset-size1.size2{font-size:1.2em}.katex .fontsize-ensurer.reset-size1.size3,.katex .sizing.reset-size1.size3{font-size:1.4em}.katex .fontsize-ensurer.reset-size1.size4,.katex .sizing.reset-size1.size4{font-size:1.6em}.katex .fontsize-ensurer.reset-size1.size5,.katex .sizing.reset-size1.size5{font-size:1.8em}.katex .fontsize-ensurer.reset-size1.size6,.katex .sizing.reset-size1.size6{font-size:2em}.katex .fontsize-ensurer.reset-size1.size7,.katex .sizing.reset-size1.size7{font-size:2.4em}.katex .fontsize-ensurer.reset-size1.size8,.katex .sizing.reset-size1.size8{font-size:2.88em}.katex .fontsize-ensurer.reset-size1.size9,.katex .sizing.reset-size1.size9{font-size:3.456em}.katex .fontsize-ensurer.reset-size1.size10,.katex .sizing.reset-size1.size10{font-size:4.148em}.katex .fontsize-ensurer.reset-size1.size11,.katex .sizing.reset-size1.size11{font-size:4.976em}.katex .fontsize-ensurer.reset-size2.size1,.katex .sizing.reset-size2.size1{font-size:.83333333em}.katex .fontsize-ensurer.reset-size2.size2,.katex .sizing.reset-size2.size2{font-size:1em}.katex .fontsize-ensurer.reset-size2.size3,.katex .sizing.reset-size2.size3{font-size:1.16666667em}.katex .fontsize-ensurer.reset-size2.size4,.katex .sizing.reset-size2.size4{font-size:1.33333333em}.katex .fontsize-ensurer.reset-size2.size5,.katex .sizing.reset-size2.size5{font-size:1.5em}.katex .fontsize-ensurer.reset-size2.size6,.katex .sizing.reset-size2.size6{font-size:1.66666667em}.katex .fontsize-ensurer.reset-size2.size7,.katex .sizing.reset-size2.size7{font-size:2em}.katex .fontsize-ensurer.reset-size2.size8,.katex .sizing.reset-size2.size8{font-size:2.4em}.katex .fontsize-ensurer.reset-size2.size9,.katex .sizing.reset-size2.size9{font-size:2.88em}.katex .fontsize-ensurer.reset-size2.size10,.katex .sizing.reset-size2.size10{font-size:3.45666667em}.katex .fontsize-ensurer.reset-size2.size11,.katex .sizing.reset-size2.size11{font-size:4.14666667em}.katex .fontsize-ensurer.reset-size3.size1,.katex .sizing.reset-size3.size1{font-size:.71428571em}.katex .fontsize-ensurer.reset-size3.size2,.katex .sizing.reset-size3.size2{font-size:.85714286em}.katex .fontsize-ensurer.reset-size3.size3,.katex .sizing.reset-size3.size3{font-size:1em}.katex .fontsize-ensurer.reset-size3.size4,.katex .sizing.reset-size3.size4{font-size:1.14285714em}.katex .fontsize-ensurer.reset-size3.size5,.katex .sizing.reset-size3.size5{font-size:1.28571429em}.katex .fontsize-ensurer.reset-size3.size6,.katex .sizing.reset-size3.size6{font-size:1.42857143em}.katex .fontsize-ensurer.reset-size3.size7,.katex .sizing.reset-size3.size7{font-size:1.71428571em}.katex .fontsize-ensurer.reset-size3.size8,.katex .sizing.reset-size3.size8{font-size:2.05714286em}.katex .fontsize-ensurer.reset-size3.size9,.katex .sizing.reset-size3.size9{font-size:2.46857143em}.katex .fontsize-ensurer.reset-size3.size10,.katex .sizing.reset-size3.size10{font-size:2.96285714em}.katex .fontsize-ensurer.reset-size3.size11,.katex .sizing.reset-size3.size11{font-size:3.55428571em}.katex .fontsize-ensurer.reset-size4.size1,.katex .sizing.reset-size4.size1{font-size:.625em}.katex .fontsize-ensurer.reset-size4.size2,.katex .sizing.reset-size4.size2{font-size:.75em}.katex .fontsize-ensurer.reset-size4.size3,.katex .sizing.reset-size4.size3{font-size:.875em}.katex .fontsize-ensurer.reset-size4.size4,.katex .sizing.reset-size4.size4{font-size:1em}.katex .fontsize-ensurer.reset-size4.size5,.katex .sizing.reset-size4.size5{font-size:1.125em}.katex .fontsize-ensurer.reset-size4.size6,.katex .sizing.reset-size4.size6{font-size:1.25em}.katex .fontsize-ensurer.reset-size4.size7,.katex .sizing.reset-size4.size7{font-size:1.5em}.katex .fontsize-ensurer.reset-size4.size8,.katex .sizing.reset-size4.size8{font-size:1.8em}.katex .fontsize-ensurer.reset-size4.size9,.katex .sizing.reset-size4.size9{font-size:2.16em}.katex .fontsize-ensurer.reset-size4.size10,.katex .sizing.reset-size4.size10{font-size:2.5925em}.katex .fontsize-ensurer.reset-size4.size11,.katex .sizing.reset-size4.size11{font-size:3.11em}.katex .fontsize-ensurer.reset-size5.size1,.katex .sizing.reset-size5.size1{font-size:.55555556em}.katex .fontsize-ensurer.reset-size5.size2,.katex .sizing.reset-size5.size2{font-size:.66666667em}.katex .fontsize-ensurer.reset-size5.size3,.katex .sizing.reset-size5.size3{font-size:.77777778em}.katex .fontsize-ensurer.reset-size5.size4,.katex .sizing.reset-size5.size4{font-size:.88888889em}.katex .fontsize-ensurer.reset-size5.size5,.katex .sizing.reset-size5.size5{font-size:1em}.katex .fontsize-ensurer.reset-size5.size6,.katex .sizing.reset-size5.size6{font-size:1.11111111em}.katex .fontsize-ensurer.reset-size5.size7,.katex .sizing.reset-size5.size7{font-size:1.33333333em}.katex .fontsize-ensurer.reset-size5.size8,.katex .sizing.reset-size5.size8{font-size:1.6em}.katex .fontsize-ensurer.reset-size5.size9,.katex .sizing.reset-size5.size9{font-size:1.92em}.katex .fontsize-ensurer.reset-size5.size10,.katex .sizing.reset-size5.size10{font-size:2.30444444em}.katex .fontsize-ensurer.reset-size5.size11,.katex .sizing.reset-size5.size11{font-size:2.76444444em}.katex .fontsize-ensurer.reset-size6.size1,.katex .sizing.reset-size6.size1{font-size:.5em}.katex .fontsize-ensurer.reset-size6.size2,.katex .sizing.reset-size6.size2{font-size:.6em}.katex .fontsize-ensurer.reset-size6.size3,.katex .sizing.reset-size6.size3{font-size:.7em}.katex .fontsize-ensurer.reset-size6.size4,.katex .sizing.reset-size6.size4{font-size:.8em}.katex .fontsize-ensurer.reset-size6.size5,.katex .sizing.reset-size6.size5{font-size:.9em}.katex .fontsize-ensurer.reset-size6.size6,.katex .sizing.reset-size6.size6{font-size:1em}.katex .fontsize-ensurer.reset-size6.size7,.katex .sizing.reset-size6.size7{font-size:1.2em}.katex .fontsize-ensurer.reset-size6.size8,.katex .sizing.reset-size6.size8{font-size:1.44em}.katex .fontsize-ensurer.reset-size6.size9,.katex .sizing.reset-size6.size9{font-size:1.728em}.katex .fontsize-ensurer.reset-size6.size10,.katex .sizing.reset-size6.size10{font-size:2.074em}.katex .fontsize-ensurer.reset-size6.size11,.katex .sizing.reset-size6.size11{font-size:2.488em}.katex .fontsize-ensurer.reset-size7.size1,.katex .sizing.reset-size7.size1{font-size:.41666667em}.katex .fontsize-ensurer.reset-size7.size2,.katex .sizing.reset-size7.size2{font-size:.5em}.katex .fontsize-ensurer.reset-size7.size3,.katex .sizing.reset-size7.size3{font-size:.58333333em}.katex .fontsize-ensurer.reset-size7.size4,.katex .sizing.reset-size7.size4{font-size:.66666667em}.katex .fontsize-ensurer.reset-size7.size5,.katex .sizing.reset-size7.size5{font-size:.75em}.katex .fontsize-ensurer.reset-size7.size6,.katex .sizing.reset-size7.size6{font-size:.83333333em}.katex .fontsize-ensurer.reset-size7.size7,.katex .sizing.reset-size7.size7{font-size:1em}.katex .fontsize-ensurer.reset-size7.size8,.katex .sizing.reset-size7.size8{font-size:1.2em}.katex .fontsize-ensurer.reset-size7.size9,.katex .sizing.reset-size7.size9{font-size:1.44em}.katex .fontsize-ensurer.reset-size7.size10,.katex .sizing.reset-size7.size10{font-size:1.72833333em}.katex .fontsize-ensurer.reset-size7.size11,.katex .sizing.reset-size7.size11{font-size:2.07333333em}.katex .fontsize-ensurer.reset-size8.size1,.katex .sizing.reset-size8.size1{font-size:.34722222em}.katex .fontsize-ensurer.reset-size8.size2,.katex .sizing.reset-size8.size2{font-size:.41666667em}.katex .fontsize-ensurer.reset-size8.size3,.katex .sizing.reset-size8.size3{font-size:.48611111em}.katex .fontsize-ensurer.reset-size8.size4,.katex .sizing.reset-size8.size4{font-size:.55555556em}.katex .fontsize-ensurer.reset-size8.size5,.katex .sizing.reset-size8.size5{font-size:.625em}.katex .fontsize-ensurer.reset-size8.size6,.katex .sizing.reset-size8.size6{font-size:.69444444em}.katex .fontsize-ensurer.reset-size8.size7,.katex .sizing.reset-size8.size7{font-size:.83333333em}.katex .fontsize-ensurer.reset-size8.size8,.katex .sizing.reset-size8.size8{font-size:1em}.katex .fontsize-ensurer.reset-size8.size9,.katex .sizing.reset-size8.size9{font-size:1.2em}.katex .fontsize-ensurer.reset-size8.size10,.katex .sizing.reset-size8.size10{font-size:1.44027778em}.katex .fontsize-ensurer.reset-size8.size11,.katex .sizing.reset-size8.size11{font-size:1.72777778em}.katex .fontsize-ensurer.reset-size9.size1,.katex .sizing.reset-size9.size1{font-size:.28935185em}.katex .fontsize-ensurer.reset-size9.size2,.katex .sizing.reset-size9.size2{font-size:.34722222em}.katex .fontsize-ensurer.reset-size9.size3,.katex .sizing.reset-size9.size3{font-size:.40509259em}.katex .fontsize-ensurer.reset-size9.size4,.katex .sizing.reset-size9.size4{font-size:.46296296em}.katex .fontsize-ensurer.reset-size9.size5,.katex .sizing.reset-size9.size5{font-size:.52083333em}.katex .fontsize-ensurer.reset-size9.size6,.katex .sizing.reset-size9.size6{font-size:.5787037em}.katex .fontsize-ensurer.reset-size9.size7,.katex .sizing.reset-size9.size7{font-size:.69444444em}.katex .fontsize-ensurer.reset-size9.size8,.katex .sizing.reset-size9.size8{font-size:.83333333em}.katex .fontsize-ensurer.reset-size9.size9,.katex .sizing.reset-size9.size9{font-size:1em}.katex .fontsize-ensurer.reset-size9.size10,.katex .sizing.reset-size9.size10{font-size:1.20023148em}.katex .fontsize-ensurer.reset-size9.size11,.katex .sizing.reset-size9.size11{font-size:1.43981481em}.katex .fontsize-ensurer.reset-size10.size1,.katex .sizing.reset-size10.size1{font-size:.24108004em}.katex .fontsize-ensurer.reset-size10.size2,.katex .sizing.reset-size10.size2{font-size:.28929605em}.katex .fontsize-ensurer.reset-size10.size3,.katex .sizing.reset-size10.size3{font-size:.33751205em}.katex .fontsize-ensurer.reset-size10.size4,.katex .sizing.reset-size10.size4{font-size:.38572806em}.katex .fontsize-ensurer.reset-size10.size5,.katex .sizing.reset-size10.size5{font-size:.43394407em}.katex .fontsize-ensurer.reset-size10.size6,.katex .sizing.reset-size10.size6{font-size:.48216008em}.katex .fontsize-ensurer.reset-size10.size7,.katex .sizing.reset-size10.size7{font-size:.57859209em}.katex .fontsize-ensurer.reset-size10.size8,.katex .sizing.reset-size10.size8{font-size:.69431051em}.katex .fontsize-ensurer.reset-size10.size9,.katex .sizing.reset-size10.size9{font-size:.83317261em}.katex .fontsize-ensurer.reset-size10.size10,.katex .sizing.reset-size10.size10{font-size:1em}.katex .fontsize-ensurer.reset-size10.size11,.katex .sizing.reset-size10.size11{font-size:1.19961427em}.katex .fontsize-ensurer.reset-size11.size1,.katex .sizing.reset-size11.size1{font-size:.20096463em}.katex .fontsize-ensurer.reset-size11.size2,.katex .sizing.reset-size11.size2{font-size:.24115756em}.katex .fontsize-ensurer.reset-size11.size3,.katex .sizing.reset-size11.size3{font-size:.28135048em}.katex .fontsize-ensurer.reset-size11.size4,.katex .sizing.reset-size11.size4{font-size:.32154341em}.katex .fontsize-ensurer.reset-size11.size5,.katex .sizing.reset-size11.size5{font-size:.36173633em}.katex .fontsize-ensurer.reset-size11.size6,.katex .sizing.reset-size11.size6{font-size:.40192926em}.katex .fontsize-ensurer.reset-size11.size7,.katex .sizing.reset-size11.size7{font-size:.48231511em}.katex .fontsize-ensurer.reset-size11.size8,.katex .sizing.reset-size11.size8{font-size:.57877814em}.katex .fontsize-ensurer.reset-size11.size9,.katex .sizing.reset-size11.size9{font-size:.69453376em}.katex .fontsize-ensurer.reset-size11.size10,.katex .sizing.reset-size11.size10{font-size:.83360129em}.katex .fontsize-ensurer.reset-size11.size11,.katex .sizing.reset-size11.size11{font-size:1em}.katex .delimsizing.size1{font-family:KaTeX_Size1}.katex .delimsizing.size2{font-family:KaTeX_Size2}.katex .delimsizing.size3{font-family:KaTeX_Size3}.katex .delimsizing.size4{font-family:KaTeX_Size4}.katex .delimsizing.mult .delim-size1>span{font-family:KaTeX_Size1}.katex .delimsizing.mult .delim-size4>span{font-family:KaTeX_Size4}.katex .nulldelimiter{display:inline-block;width:.12em}.katex .delimcenter,.katex .op-symbol{position:relative}.katex .op-symbol.small-op{font-family:KaTeX_Size1}.katex .op-symbol.large-op{font-family:KaTeX_Size2}.katex .accent>.vlist-t,.katex .op-limits>.vlist-t{text-align:center}.katex .accent .accent-body{position:relative}.katex .accent .accent-body:not(.accent-full){width:0}.katex .overlay{display:block}.katex .mtable .vertical-separator{display:inline-block;min-width:1px}.katex .mtable .arraycolsep{display:inline-block}.katex .mtable .col-align-c>.vlist-t{text-align:center}.katex .mtable .col-align-l>.vlist-t{text-align:left}.katex .mtable .col-align-r>.vlist-t{text-align:right}.katex .svg-align{text-align:left}.katex svg{display:block;position:absolute;width:100%;height:inherit;fill:currentColor;stroke:currentColor;fill-rule:nonzero;fill-opacity:1;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1}.katex svg path{stroke:none}.katex img{border-style:none;min-width:0;min-height:0;max-width:none;max-height:none}.katex .stretchy{width:100%;display:block;position:relative;overflow:hidden}.katex .stretchy:after,.katex .stretchy:before{content:""}.katex .hide-tail{width:100%;position:relative;overflow:hidden}.katex .halfarrow-left{position:absolute;left:0;width:50.2%;overflow:hidden}.katex .halfarrow-right{position:absolute;right:0;width:50.2%;overflow:hidden}.katex .brace-left{position:absolute;left:0;width:25.1%;overflow:hidden}.katex .brace-center{position:absolute;left:25%;width:50%;overflow:hidden}.katex .brace-right{position:absolute;right:0;width:25.1%;overflow:hidden}.katex .x-arrow-pad{padding:0 .5em}.katex .cd-arrow-pad{padding:0 .55556em 0 .27778em}.katex .mover,.katex .munder,.katex .x-arrow{text-align:center}.katex .boxpad{padding:0 .3em}.katex .fbox,.katex .fcolorbox{box-sizing:border-box;border:.04em solid}.katex .cancel-pad{padding:0 .2em}.katex .cancel-lap{margin-left:-.2em;margin-right:-.2em}.katex .sout{border-bottom-style:solid;border-bottom-width:.08em}.katex .angl{box-sizing:border-content;border-top:.049em solid;border-right:.049em solid;margin-right:.03889em}.katex .anglpad{padding:0 .03889em}.katex .eqn-num:before{counter-increment:katexEqnNo;content:"(" counter(katexEqnNo) ")"}.katex .mml-eqn-num:before{counter-increment:mmlEqnNo;content:"(" counter(mmlEqnNo) ")"}.katex .mtr-glue{width:50%}.katex .cd-vert-arrow{display:inline-block;position:relative}.katex .cd-label-left{display:inline-block;position:absolute;right:calc(50% + .3em);text-align:left}.katex .cd-label-right{display:inline-block;position:absolute;left:calc(50% + .3em);text-align:right}.katex-display{display:block;margin:1em 0;text-align:center}.katex-display>.katex{display:block;text-align:center;white-space:nowrap}.katex-display>.katex>.katex-html{display:block;position:relative}.katex-display>.katex>.katex-html>.tag{position:absolute;right:0}.katex-display.leqno>.katex>.katex-html>.tag{left:0;right:auto}.katex-display.fleqn>.katex{text-align:left;padding-left:2em}body{counter-reset:katexEqnNo mmlEqnNo}

/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

.katex-error {
	color: var(--vscode-editorError-foreground);
}

</style>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css" integrity="sha384-yFRtMMDnQtDRO8rLpMIKrtPCD5jdktao2TV19YiZYWMDkUR5GQZR/NOVTdquEx1j" crossorigin="anonymous">
<link href="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.css" rel="stylesheet" type="text/css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/markdown.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/highlight.css">
<style>
            body {
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe WPC', 'Segoe UI', system-ui, 'Ubuntu', 'Droid Sans', sans-serif;
                font-size: 14px;
                line-height: 1.6;
            }
        </style>
        <style>
.task-list-item { list-style-type: none; } .task-list-item-checkbox { margin-left: -20px; vertical-align: middle; }
</style>
        
        <script src="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.js"></script>
        
    </head>
    <body class="vscode-body vscode-light">
        <h1 id="general-info">General info</h1>
<p>The first part in this readme contains some test and exploratory / curiosity commands.<br>
The <code>Homework</code> itself is the last section, here is the link right to it: <a href="#Homework">the Homework </a></p>
<h1 id="class-drills">Class drills</h1>
<h2 id="creating-secret-cm-and-a-pod">Creating secret, cm and a pod</h2>
<pre><code><code><div>kubectl create secret generic connection-string --from-literal=DATABASE_URL=postgres://connect --dry-run=client -o yaml &gt; secret.yaml
kubectl create configmap user --from-literal=firstname=firstname --from-literal=lastname=lastname --dry-run=client -o yaml &gt; cm.yaml
kubectl apply -f secret.yaml
kubectl apply -f cm.yaml
kubectl apply -f pod.yaml
</div></code></code></pre>
<p>ConfigMap name is 'user'</p>
<pre><code><code><div>metadata:
  creationTimestamp: null
  name: user
k get cm
&gt; NAME               DATA   AGE
&gt; kube-root-ca.crt   1      40d
&gt; user               2      7m59s
</div></code></code></pre>
<p>Two ways to reference <code>secret</code> / <code>ConfigMap</code> from the <code>Pod</code> - entire file or only selected entities. Env. variable name can be set / changed in the latter case.</p>
<pre><code><code><div>    env:
    - name: DATABASE_URL
      valueFrom:
        secretKeyRef:
          name: connection-string
          key: DATABASE_URL
    envFrom:
      - configMapRef:
          name: user
</div></code></code></pre>
<p>Changing key name in the <code>secret</code> like this</p>
<pre><code><code><div>      valueFrom:
        secretKeyRef:
          name: connection-string
          key: DATABASE_URL222
</div></code></code></pre>
<p>will result in pod failing to start:</p>
<pre><code><code><div>  Warning  Failed     8s (x3 over 38s)   kubelet            Error: couldn't find key DATABASE_URL in Secret default/connection-string
</div></code></code></pre>
<p>Decoding the secret</p>
<pre><code><code><div>k get secret connection-string -o yaml | grep &quot;DATABASE_URL:&quot; | awk '{print $2}' | base64 -d
&gt; postgres://connect
k get secret connection-string -o jsonpath='{.data.DATABASE_URL}' |
 base64 -d
&gt; postgres://connect
</div></code></code></pre>
<p>Getting inside the container and printing its env outputs, among others, the <code>firstname</code> and <code>lastname</code> env vars from the ConfigMap and <code>DATABASE_URL</code> from the secret</p>
<pre><code><code><div>tsar@DESKTOP-80THIFC:task_2$ kubectl exec -it nginx -- bash
root@nginx:/# printenv
&gt; ...
&gt; lastname=lastname
&gt; firstname=firstname
&gt; DATABASE_URL=postgres://connect
</div></code></code></pre>
<h2 id="adding-nginx-deploy">Adding nginx deploy</h2>
<pre><code><code><div>kubectl apply -f nginx-configmap.yaml
kubectl apply -f deployment.yaml

tsar@DESKTOP-80THIFC:task_2$ k get deploy,po,cm,secret
&gt; NAME                  READY   UP-TO-DATE   AVAILABLE   AGE
&gt; deployment.apps/web   3/3     3            3           47s
&gt; 
&gt; NAME                       READY   STATUS    RESTARTS   AGE
&gt; pod/nginx                  1/1     Running   0          7m1s
&gt; pod/web-5584c6c5c6-bkmhz   1/1     Running   0          47s
&gt; pod/web-5584c6c5c6-j52tl   1/1     Running   0          47s
&gt; pod/web-5584c6c5c6-ssl8f   1/1     Running   0          47s
&gt; 
&gt; NAME                         DATA   AGE
&gt; configmap/kube-root-ca.crt   1      40d
&gt; configmap/nginx-configmap    1      48s
&gt; configmap/user               2      30m
&gt; 
&gt; NAME                         TYPE                                  DATA   &gt; AGE
&gt; secret/connection-string     Opaque                                1      &gt; 30m
&gt; secret/default-token-qtjrj   kubernetes.io/service-account-token   3      40d

tsar@DESKTOP-80THIFC:task_2$ k get cm nginx-configmap -o yaml
apiVersion: v1
data:
  default.conf: |-
    server {
        listen 80 default_server;
        server_name _;
        default_type text/plain;

        location / {
            return 200 '$hostname\n';
        }
    }
kind: ConfigMap
metadata:
  annotations:
    kubectl.kubernetes.io/last-applied-configuration: |
      {&quot;apiVersion&quot;:&quot;v1&quot;,&quot;data&quot;:{&quot;default.conf&quot;:&quot;server {\n    listen 80 default_server;\n    server_name _;\n    default_type text/plain;\n\n    location / {\n        return 200 '$hostname\\n';\n    }\n}&quot;},&quot;kind&quot;:&quot;ConfigMap&quot;,&quot;metadata&quot;:{&quot;annotations&quot;:{},&quot;creationTimestamp&quot;:null,&quot;name&quot;:&quot;nginx-configmap&quot;,&quot;namespace&quot;:&quot;default&quot;}}
  creationTimestamp: &quot;2022-01-31T12:00:25Z&quot;
  name: nginx-configmap
  namespace: default
  resourceVersion: &quot;802&quot;
  uid: f050bf02-35ce-4240-a21c-d0e107ca22bf
</div></code></code></pre>
<h2 id="connecting-to-pods">Connecting to pods</h2>
<h3 id="via-pod-ip">Via Pod IP</h3>
<pre><code><code><div>tsar@DESKTOP-80THIFC:task_2$ k get po -o wide
&gt; NAME                   READY   STATUS    RESTARTS   AGE     IP           NODE       NOMINATED NODE   READINESS GATES
&gt; nginx                  1/1     Running   0          5m30s   172.17.0.2   minikube   &lt;none&gt;           &lt;none&gt;
&gt; web-5584c6c5c6-hddgw   1/1     Running   0          4m9s    172.17.0.9   minikube   &lt;none&gt;           &lt;none&gt;
&gt; web-5584c6c5c6-kjwx4   1/1     Running   0          4m9s    172.17.0.7   minikube   &lt;none&gt;           &lt;none&gt;
&gt; web-5584c6c5c6-tnfr5   1/1     Running   0          4m9s    172.17.0.8   minikube   &lt;none&gt;           &lt;none&gt;
</div></code></code></pre>
<ul>
<li>Try connect to pod with curl (curl pod_ip_address). What happens?</li>
<li>From you PC</li>
<li>From minikube (minikube ssh)</li>
<li>From another pod (kubectl exec -it $(kubectl get pod |awk '{print $1}'|grep web-|head -n1) bash)</li>
</ul>
<p>curl doesn't work from the host, but works from the minikube node and other pods</p>
<pre><code><code><div>tsar@DESKTOP-80THIFC:task_2$ curl 172.17.0.9
curl: (28) Failed to connect to 172.17.0.9 port 80: Connection timed out

docker@minikube:~$ curl 172.17.0.9
web-5584c6c5c6-hddgw
docker@minikube:~$ curl 172.17.0.7
web-5584c6c5c6-kjwx4

root@web-5584c6c5c6-hddgw:/# curl 172.17.0.9
web-5584c6c5c6-hddgw
root@web-5584c6c5c6-hddgw:/# curl 172.17.0.7
web-5584c6c5c6-kjwx4
</div></code></code></pre>
<h3 id="via-service-clusterip">Via Service ClusterIP</h3>
<pre><code><code><div>tsar@DESKTOP-80THIFC:task_2$ k expose deployment/web --type=ClusterIP --dry-run=client -o yaml &gt; service_template.yaml
tsar@DESKTOP-80THIFC:task_2$ k apply -f service_template.yaml
&gt; service/web created
tsar@DESKTOP-80THIFC:task_2$ k get svc
&gt; NAME         TYPE        CLUSTER-IP    EXTERNAL-IP   PORT(S)   AGE
&gt; kubernetes   ClusterIP   10.96.0.1     &lt;none&gt;        443/TCP   28m
&gt; web          ClusterIP   10.97.90.37   &lt;none&gt;        80/TCP    3s
</div></code></code></pre>
<ul>
<li>Try connect to service (curl service_ip_address). What happens?</li>
<li>From you PC</li>
<li>From minikube (minikube ssh) (run the command several times)</li>
<li>From another pod (kubectl exec -it $(kubectl get pod |awk '{print $1}'|grep web-|head -n1) bash) (run the command several times)</li>
</ul>
<p>curl still doesn't work from the host, but works from the minikube node and other pods
It works differently now, though - service returns different hosts</p>
<pre><code><code><div>tsar@DESKTOP-80THIFC:task_2$ curl 172.17.0.9
curl: (28) Failed to connect to 172.17.0.9 port 80: Connection timed out

docker@minikube:~$ curl 10.97.90.37
web-5584c6c5c6-hddgw
docker@minikube:~$ curl 10.97.90.37
web-5584c6c5c6-tnfr5

root@web-5584c6c5c6-hddgw:/# curl 10.97.90.37
web-5584c6c5c6-kjwx4
root@web-5584c6c5c6-hddgw:/# curl 10.97.90.37
web-5584c6c5c6-tnfr5
</div></code></code></pre>
<h3 id="via-service-nodeport">Via Service NodePort</h3>
<pre><code><code><div>kubectl apply -f service-nodeport.yaml
&gt; service/web-np created
tsar@DESKTOP-80THIFC:task_2$ kubectl get service
&gt; NAME         TYPE        CLUSTER-IP       EXTERNAL-IP   PORT(S)        AGE
&gt; kubernetes   ClusterIP   10.96.0.1        &lt;none&gt;        443/TCP        49m
&gt; web          ClusterIP   10.97.90.37      &lt;none&gt;        80/TCP         21m
&gt; web-np       NodePort    10.103.138.236   &lt;none&gt;        80:30755/TCP   0s
minikube ip
&gt; 192.168.49.2
</div></code></code></pre>
<p>Still works from minikube host and other pods and doesn't work from the host.</p>
<pre><code><code><div>tsar@DESKTOP-80THIFC:task_2$ curl 192.168.49.2:30755
curl: (28) Failed to connect to 192.168.49.2 port 30755: Connection timed out

docker@minikube:~$ curl 192.168.49.2:30755
web-5584c6c5c6-hddgw
docker@minikube:~$ curl 192.168.49.2:30755
web-5584c6c5c6-kjwx4

root@web-5584c6c5c6-tnfr5:/# curl 192.168.49.2:30755
web-5584c6c5c6-hddgw
root@web-5584c6c5c6-tnfr5:/# curl 192.168.49.2:30755
web-5584c6c5c6-kjwx4
</div></code></code></pre>
<h3 id="headless-service">Headless Service</h3>
<pre><code><code><div>kubectl apply -f service-headless.yaml
tsar@DESKTOP-80THIFC:task_2$ kubectl exec -it web-5584c6c5c6-hddgw -- bash
root@web-5584c6c5c6-hddgw:/# cat /etc/resolv.conf
&gt; nameserver 10.96.0.10
&gt; search default.svc.cluster.local svc.cluster.local cluster.local
&gt; options ndots:5
tsar@DESKTOP-80THIFC:task_2$ kubectl get ep
&gt; NAME           ENDPOINTS                                   AGE
&gt; kubernetes     192.168.49.2:8443                           79m
&gt; web            172.17.0.7:80,172.17.0.8:80,172.17.0.9:80   50m
&gt; web-headless   172.17.0.7:80,172.17.0.8:80,172.17.0.9:80   23m
&gt; web-np         172.17.0.7:80,172.17.0.8:80,172.17.0.9:80   29m
</div></code></code></pre>
<ul>
<li>Compare the IP address of the DNS server in the pod and the DNS service of the Kubernetes cluster.</li>
<li>Compare headless and clusterip</li>
<li>Inside the pod run nslookup to normal clusterip and headless. Compare the results.</li>
</ul>
<pre><code><code><div>kubectl -n default create deploy busybox --image=busybox -- /bin/sh -c &quot;while true; do sleep 30; done;&quot;
kubectl -n default create deploy busybox-curl --image=zemond/busybox-curl -- /bin/sh -c &quot;wh
ile true; do sleep 30; done;&quot;
kubectl run -i --tty --rm debug --image=busybox --restart=Never -- sh

tsar@DESKTOP-80THIFC:task_2$ k get svc,po -o wide
&gt; NAME                   TYPE        CLUSTER-IP       EXTERNAL-IP   PORT(S)        AGE     SELECTOR
&gt; service/kubernetes     ClusterIP   10.96.0.1        &lt;none&gt;        443/TCP        3h56m   &lt;none&gt;
&gt; service/web            ClusterIP   10.97.90.37      &lt;none&gt;        80/TCP         3h27m   app=web
&gt; service/web-headless   ClusterIP   None             &lt;none&gt;        80/TCP         179m    app=web
&gt; service/web-np         NodePort    10.103.138.236   &lt;none&gt;        80:30755/TCP   3h6m    app=web

&gt; NAME                                READY   STATUS    RESTARTS   AGE     IP            NODE    
&gt; pod/busybox-596d5d8fd6-dxplx        1/1     Running   0          30m     172.17.0.10   minikube
&gt; pod/busybox-curl-55bf5999d7-zkcfm   1/1     Running   0          28m     172.17.0.11   minikube
&gt; pod/nginx                           1/1     Running   0          3h54m   172.17.0.2    minikube
&gt; pod/web-5584c6c5c6-hddgw            1/1     Running   0          3h52m   172.17.0.9    minikube
&gt; pod/web-5584c6c5c6-kjwx4            1/1     Running   0          3h52m   172.17.0.7    minikube
&gt; pod/web-5584c6c5c6-tnfr5            1/1     Running   0          3h52m   172.17.0.8    minikube

tsar@DESKTOP-80THIFC:task_2$ k exec -it busybox-curl-55bf5999d7-zkcfm -- sh
/home # curl web
&gt; web-5584c6c5c6-kjwx4
/home # nslookup web
&gt; Server:    10.96.0.10
&gt; Address 1: 10.96.0.10 kube-dns.kube-system.svc.cluster.local
&gt; Name:      web
&gt; Address 1: 10.97.90.37 web.default.svc.cluster.local

/home # nslookup web-np
&gt; Server:    10.96.0.10
&gt; Address 1: 10.96.0.10 kube-dns.kube-system.svc.cluster.local
&gt; Name:      web-np
&gt; Address 1: 10.103.138.236 web-np.default.svc.cluster.local

/home # nslookup web-headless
&gt; Server:    10.96.0.10
&gt; Address 1: 10.96.0.10 kube-dns.kube-system.svc.cluster.local
&gt; Name:      web-headless
&gt; Address 1: 172.17.0.8 172-17-0-8.web-np.default.svc.cluster.local
&gt; Address 2: 172.17.0.7 172-17-0-7.web.default.svc.cluster.local
&gt; Address 3: 172.17.0.9 172-17-0-9.web.default.svc.cluster.local

/home # cat /etc/resolv.conf
nameserver 10.96.0.10
search default.svc.cluster.local svc.cluster.local cluster.local
options ndots:5
</div></code></code></pre>
<p>So apparently
<code>nslookup web</code>          returns service   ClusterIP
<code>nslookup web-np</code>       returns service's ClusterIP
<code>nslookup web-headless</code> returns a list of IPs of the pods</p>
<h3 id="ingress">Ingress</h3>
<pre><code><code><div>minikube addons enable ingress
minikube addons list
kubectl get pods -n ingress-nginx
kubectl get pod $(kubectl get pod -n ingress-nginx|grep ingress-nginx-controller|awk '{print $1}') -n ingress-nginx -o yaml
minikube tunnel
curl localhost
&gt; web-5584c6c5c6-hddgw
curl localhost
&gt; web-5584c6c5c6-tnfr5
</div></code></code></pre>
<h1 id="homework">Homework</h1>
<ul>
<li>
<p>In Minikube in namespace kube-system, there are many different pods running. Your task is to figure out who creates them, and who makes sure they are running (restores them after deletion).</p>
</li>
<li>
<p>Implement Canary deployment of an application via Ingress. Traffic to canary deployment should be redirected if you add &quot;canary:always&quot; in the header, otherwise it should go to regular deployment.
Set to redirect a percentage of traffic to canary deployment.</p>
</li>
</ul>
<h2 id="part-1-kube-system-namespace">Part 1 kube-system namespace</h2>
<ul>
<li>In Minikube in namespace kube-system, there are many different pods running. Your task is to figure out who creates them, and who makes sure they are running (restores them after deletion).</li>
</ul>
<h3 id="general-thoughts">General thoughts</h3>
<p>Not sure I understand the question correctly, but here are my thoughts on it...</p>
<p>Apparently, in <code>Minikube</code> most pods in the <code>kube-system</code> namespace are created as static pods and the manifests for them are stored in <code>/etc/kubernetes/manifests</code> and the pods are managed the <code>kubelet</code> daemon on a specific node, <code>control plane</code>, in this case.</p>
<p><a href="https://kubernetes.io/docs/reference/setup-tools/kubeadm/implementation-details/">Here is the link to the reference doc</a> and <a href="https://kubernetes.io/docs/tasks/configure-pod-container/static-pod/">here is another one</a>.</p>
<p><code>coredns</code> is an addon and Minikube has an addon manager that periodically verifies the configuration state of any installed addons, and Kube-DNS is one of those addons <a href="https://coredns.io/2017/04/28/coredns-for-minikube/">source</a>.</p>
<p><code>kube-proxy</code> in <code>Minikube</code> is deployed as a <code>daemonset</code> but I'm not sure <s>who watches the watchmen</s> who controls the DaemonSet itself.</p>
<pre><code><code><div>docker@minikube:~$ ll /etc/kubernetes/manifests/
total 28
drwxr-xr-x 1 root root 4096 Feb  2 16:44 ./
drwxr-xr-x 1 root root 4096 Feb  2 16:44 ../
-rw------- 1 root root 2309 Feb  2 16:44 etcd.yaml
-rw------- 1 root root 4071 Feb  2 16:44 kube-apiserver.yaml
-rw------- 1 root root 3405 Feb  2 16:44 kube-controller-manager.yaml
-rw------- 1 root root 1451 Feb  2 16:44 kube-scheduler.yaml
</div></code></code></pre>
<h3 id="out-of-the-box-state-of-the-kube-system-namespace">Out of the box state of the kube-system Namespace</h3>
<pre><code><code><div>$ kubectl get deploy,rs,ds,po,svc,ep,sa,secret,cm -n kube-system
&gt; NAME                      READY   UP-TO-DATE   AVAILABLE   AGE
&gt; deployment.apps/coredns   1/1     1            1           14h
&gt; 
&gt; NAME                                 DESIRED   CURRENT   READY   AGE
&gt; replicaset.apps/coredns-78fcd69978   1         1         1       14h
&gt; 
&gt; NAME                        DESIRED   CURRENT   READY   UP-TO-DATE   AVAILABLE   NODE SELECTOR            AGE
&gt; daemonset.apps/kube-proxy   1         1         1       1            1           kubernetes.io/os=linux   14h
&gt; 
&gt; NAME                                   READY   STATUS    RESTARTS   AGE
&gt; pod/coredns-78fcd69978-mj4z7           1/1     Running   0          13h
&gt; pod/etcd-minikube                      1/1     Running   17         13h
&gt; pod/kube-apiserver-minikube            1/1     Running   17         13h
&gt; pod/kube-controller-manager-minikube   1/1     Running   17         13h
&gt; pod/kube-proxy-hnndh                   1/1     Running   0          13h
&gt; pod/kube-scheduler-minikube            1/1     Running   17         13h
&gt; 
&gt; NAME               TYPE        CLUSTER-IP   EXTERNAL-IP   PORT(S)                  AGE
&gt; service/kube-dns   ClusterIP   10.96.0.10   &lt;none&gt;        53/UDP,53/TCP,9153/TCP   14h
&gt; 
&gt; NAME                                 ENDPOINTS                                     AGE
&gt; endpoints/k8s.io-minikube-hostpath   &lt;none&gt;                                        14h
&gt; endpoints/kube-dns                   172.17.0.2:53,172.17.0.2:53,172.17.0.2:9153   14h
&gt; 
&gt; NAME                                                SECRETS   AGE
&gt; serviceaccount/attachdetach-controller              1         14h
&gt; serviceaccount/bootstrap-signer                     1         14h
&gt; serviceaccount/certificate-controller               1         14h
&gt; serviceaccount/clusterrole-aggregation-controller   1         14h
&gt; serviceaccount/coredns                              1         14h
&gt; serviceaccount/cronjob-controller                   1         14h
&gt; serviceaccount/daemon-set-controller                1         14h
&gt; serviceaccount/default                              1         14h
&gt; serviceaccount/deployment-controller                1         14h
&gt; serviceaccount/disruption-controller                1         14h
&gt; serviceaccount/endpoint-controller                  1         14h
&gt; serviceaccount/endpointslice-controller             1         14h
&gt; serviceaccount/endpointslicemirroring-controller    1         14h
&gt; serviceaccount/ephemeral-volume-controller          1         14h
&gt; serviceaccount/expand-controller                    1         14h
&gt; serviceaccount/generic-garbage-collector            1         14h
&gt; serviceaccount/horizontal-pod-autoscaler            1         14h
&gt; serviceaccount/job-controller                       1         14h
&gt; serviceaccount/kube-proxy                           1         14h
&gt; serviceaccount/namespace-controller                 1         14h
&gt; serviceaccount/node-controller                      1         14h
&gt; serviceaccount/persistent-volume-binder             1         14h
&gt; serviceaccount/pod-garbage-collector                1         14h
&gt; serviceaccount/pv-protection-controller             1         14h
&gt; serviceaccount/pvc-protection-controller            1         14h
&gt; serviceaccount/replicaset-controller                1         14h
&gt; serviceaccount/replication-controller               1         14h
&gt; serviceaccount/resourcequota-controller             1         14h
&gt; serviceaccount/root-ca-cert-publisher               1         14h
&gt; serviceaccount/service-account-controller           1         14h
&gt; serviceaccount/service-controller                   1         14h
&gt; serviceaccount/statefulset-controller               1         14h
&gt; serviceaccount/storage-provisioner                  1         14h
&gt; serviceaccount/token-cleaner                        1         14h
&gt; serviceaccount/ttl-after-finished-controller        1         14h
&gt; serviceaccount/ttl-controller                       1         14h
&gt; 
&gt; NAME                                                    TYPE                                  DATA   AGE
&gt; secret/attachdetach-controller-token-j8x7h              kubernetes.io/service-account-token   3      14h
&gt; secret/bootstrap-signer-token-st4j9                     kubernetes.io/service-account-token   3      14h
&gt; secret/bootstrap-token-q1fjwy                           bootstrap.kubernetes.io/token         6      14h
&gt; secret/certificate-controller-token-rzt4v               kubernetes.io/service-account-token   3      14h
&gt; secret/clusterrole-aggregation-controller-token-zjtdx   kubernetes.io/service-account-token   3      14h
&gt; secret/coredns-token-sjsxm                              kubernetes.io/service-account-token   3      14h
&gt; secret/cronjob-controller-token-cd8mf                   kubernetes.io/service-account-token   3      14h
&gt; secret/daemon-set-controller-token-zjz9t                kubernetes.io/service-account-token   3      14h
&gt; secret/default-token-7tpvl                              kubernetes.io/service-account-token   3      14h
&gt; secret/deployment-controller-token-54w92                kubernetes.io/service-account-token   3      14h
&gt; secret/disruption-controller-token-zxxzp                kubernetes.io/service-account-token   3      14h
&gt; secret/endpoint-controller-token-rvxxd                  kubernetes.io/service-account-token   3      14h
&gt; secret/endpointslice-controller-token-md9b4             kubernetes.io/service-account-token   3      14h
&gt; secret/endpointslicemirroring-controller-token-ngxrb    kubernetes.io/service-account-token   3      14h
&gt; secret/ephemeral-volume-controller-token-c8brw          kubernetes.io/service-account-token   3      14h
&gt; secret/expand-controller-token-6crr8                    kubernetes.io/service-account-token   3      14h
&gt; secret/generic-garbage-collector-token-6ww79            kubernetes.io/service-account-token   3      14h
&gt; secret/horizontal-pod-autoscaler-token-jlsck            kubernetes.io/service-account-token   3      14h
&gt; secret/job-controller-token-n68hb                       kubernetes.io/service-account-token   3      14h
&gt; secret/kube-proxy-token-2hg8k                           kubernetes.io/service-account-token   3      14h
&gt; secret/namespace-controller-token-rrxr9                 kubernetes.io/service-account-token   3      14h
&gt; secret/node-controller-token-z8nsb                      kubernetes.io/service-account-token   3      14h
&gt; secret/persistent-volume-binder-token-4fpcs             kubernetes.io/service-account-token   3      14h
&gt; secret/pod-garbage-collector-token-ql4cs                kubernetes.io/service-account-token   3      14h
&gt; secret/pv-protection-controller-token-pd42f             kubernetes.io/service-account-token   3      14h
&gt; secret/pvc-protection-controller-token-zl9sz            kubernetes.io/service-account-token   3      14h
&gt; secret/replicaset-controller-token-kdtvv                kubernetes.io/service-account-token   3      14h
&gt; secret/replication-controller-token-2txl7               kubernetes.io/service-account-token   3      14h
&gt; secret/resourcequota-controller-token-8qxkr             kubernetes.io/service-account-token   3      14h
&gt; secret/root-ca-cert-publisher-token-w8v4f               kubernetes.io/service-account-token   3      14h
&gt; secret/service-account-controller-token-vfc8q           kubernetes.io/service-account-token   3      14h
&gt; secret/service-controller-token-rd2cw                   kubernetes.io/service-account-token   3      14h
&gt; secret/statefulset-controller-token-kdzxl               kubernetes.io/service-account-token   3      14h
&gt; secret/storage-provisioner-token-8q7wj                  kubernetes.io/service-account-token   3      14h
&gt; secret/token-cleaner-token-lltz4                        kubernetes.io/service-account-token   3      14h
&gt; secret/ttl-after-finished-controller-token-psljd        kubernetes.io/service-account-token   3      14h
&gt; secret/ttl-controller-token-gjx4k                       kubernetes.io/service-account-token   3      14h
&gt; 
&gt; NAME                                           DATA   AGE
&gt; configmap/coredns                              1      14h
&gt; configmap/extension-apiserver-authentication   6      14h
&gt; configmap/kube-proxy                           2      14h
&gt; configmap/kube-root-ca.crt                     1      14h
&gt; configmap/kubeadm-config                       1      14h
&gt; configmap/kubelet-config-1.22                  1      14h
</div></code></code></pre>
<h2 id="part-2-canary-ingress">Part 2 Canary Ingress</h2>
<ul>
<li>Implement Canary deployment of an application via Ingress. Traffic to canary deployment should be redirected if you add &quot;canary:always&quot; in the header, otherwise it should go to regular deployment.
Set to redirect a percentage of traffic to canary deployment.</li>
</ul>
<blockquote>
<p>All the manifests and the Dockerfile for this task are located in the <code>./canary</code> folder</p>
</blockquote>
<h3 id="building-docker-images-for-app-v10-and-20">Building Docker images for app v1.0 and 2.0</h3>
<pre><code><code><div>PROJECT_ID=k8s-canary
app_version=1.0
docker build --build-arg version=$app_version -t tsarspb/$PROJECT_ID:$app_version .
docker tag tsarspb/$PROJECT_ID:$app_version tsarspb/$PROJECT_ID:latest
docker images &quot;tsarspb/*&quot;
&gt; REPOSITORY           TAG       IMAGE ID       CREATED         SIZE
&gt; tsarspb/k8s-canary   1.0       43584252353d   9 minutes ago   11.4MB
&gt; tsarspb/k8s-canary   latest    43584252353d   9 minutes ago   11.4MB
docker login -u tsarspb
docker push tsarspb/$PROJECT_ID:latest
docker push tsarspb/$PROJECT_ID:$app_version

app_version=2.0
docker build --build-arg version=$app_version -t tsarspb/$PROJECT_ID:$app_version .

$ docker tag tsarspb/$PROJECT_ID:$app_version tsarspb/$PROJECT_ID:latest
$ docker images &quot;tsarspb/*&quot;
&gt; REPOSITORY           TAG       IMAGE ID       CREATED          SIZE
&gt; tsarspb/k8s-canary   2.0       c7df76fd622b   47 seconds ago   11.4MB
&gt; tsarspb/k8s-canary   latest    c7df76fd622b   47 seconds ago   11.4MB
&gt; tsarspb/k8s-canary   1.0       43584252353d   42 minutes ago   11.4MB

docker push tsarspb/$PROJECT_ID:latest
docker push tsarspb/$PROJECT_ID:$app_version
</div></code></code></pre>
<h3 id="deploying-production-v10-and-canary-v20-versions-of-the-app">Deploying &quot;Production&quot; v1.0 and &quot;Canary&quot; v2.0 versions of the app</h3>
<pre><code><code><div>kubectl create ns prod
kubectl apply -f ./deploy.yaml -n prod
kubectl apply -f ./deploy-canary.yaml -n prod

$ kubectl get po -n prod
&gt; NAME                                  READY   STATUS    RESTARTS   AGE
&gt; kubeapp-canary-56476554c4-wwgjw       1/1     Running   0          27s
&gt; kubeapp-production-6556ddf7b8-kk55v   1/1     Running   0          4m20s
&gt; kubeapp-production-6556ddf7b8-kls57   1/1     Running   0          4m20s
&gt; kubeapp-production-6556ddf7b8-m2cqm   1/1     Running   0          4m20s
</div></code></code></pre>
<h3 id="deploying-production-and-canary-services">Deploying Production and Canary services</h3>
<pre><code><code><div>$ kubectl apply -f ./service-np.yaml -n prod
&gt; service/kubeapp-production-service created
$ kubectl apply -f ./service-np-canary.yaml -n prod
&gt; service/kubeapp-canary-service created

$ kubectl get svc -n prod
&gt; NAME                         TYPE       CLUSTER-IP       EXTERNAL-IP   PORT(S)        AGE
&gt; kubeapp-canary-service       NodePort   10.102.24.194    &lt;none&gt;        81:31022/TCP   6s
&gt; kubeapp-production-service   NodePort   10.104.220.185   &lt;none&gt;        81:32624/TCP   14s
</div></code></code></pre>
<h3 id="deploying-ingress">Deploying ingress</h3>
<pre><code><code><div>$ kubectl apply -f ./ingress.yaml -n prod
&gt; ingress.networking.k8s.io/app-ingress created

$ kubectl apply -f ./ingress-canary.yaml -n prod
&gt; ingress.networking.k8s.io/app-ingress-canary created

$ kubectl get svc,ing -n prod
&gt; NAME                                 TYPE       CLUSTER-IP       EXTERNAL-IP   PORT(S)        AGE
&gt; service/kubeapp-canary-service       NodePort   10.102.24.194    &lt;none&gt;        81:31022/TCP   10m
&gt; service/kubeapp-production-service   NodePort   10.104.220.185   &lt;none&gt;        81:32624/TCP   10m
&gt; 
&gt; NAME                                           CLASS    HOSTS   ADDRESS     PORTS   AGE
&gt; ingress.networking.k8s.io/app-ingress          &lt;none&gt;   *       localhost   80      2m3s
&gt; ingress.networking.k8s.io/app-ingress-canary   &lt;none&gt;   *       localhost   80      115s
</div></code></code></pre>
<h3 id="testing-the-configuration">Testing the configuration</h3>
<blockquote>
<p>I've deviated a bit from the strict definition of the task and added <code>canary-weight</code> annotation just for the sake of experiment / as as part of exploration, so my ingress never always returns some % of &quot;canary&quot; version.</p>
</blockquote>
<p>Here is the excerpt from the app-ingress-canary</p>
<pre><code><code><div>metadata:
  name: app-ingress-canary
  annotations:
    kubernetes.io/ingress.class: nginx
    nginx.ingress.kubernetes.io/canary: &quot;true&quot;
    nginx.ingress.kubernetes.io/canary-weight: &quot;10&quot;
    nginx.ingress.kubernetes.io/canary-by-header: &quot;canary&quot;
</div></code></code></pre>
<p>We shoud be routed to the canary v2.0 in ~10% requests when the &quot;canary&quot; header is not specified or its value isn't &quot;always&quot; (in this case ingress falls back to routing based on weight) or in 100% requests when the value of the &quot;canary&quot; header is set to &quot;always&quot;.</p>
<h4 id="no-header-specified">No header specified</h4>
<p>Ingress falls back to routing based on weight and should route to the canary v2.0 in ~10% requests</p>
<pre><code><code><div>minikube tunnel
$ while true; do curl localhost; echo ; sleep 1; done;
&gt; Congratulations! Version 1.0 of your application is running on Kubernetes.
&gt; Congratulations! Version 1.0 of your application is running on Kubernetes.
&gt; Congratulations! Version 1.0 of your application is running on Kubernetes.
&gt; Congratulations! Version 2.0 of your application is running on Kubernetes.
&gt; Congratulations! Version 1.0 of your application is running on Kubernetes.
&gt; Congratulations! Version 1.0 of your application is running on Kubernetes.
&gt; Congratulations! Version 1.0 of your application is running on Kubernetes.
&gt; Congratulations! Version 1.0 of your application is running on Kubernetes.
&gt; Congratulations! Version 2.0 of your application is running on Kubernetes.
</div></code></code></pre>
<h4 id="canaryalways-header-is-specified">&quot;canary:always&quot; header is specified</h4>
<p>Ingress routes all the requests to the canary v2.0</p>
<pre><code><code><div>$ while true; do curl -H &quot;canary:always&quot; localhost; echo ; sleep 1; done;
Congratulations! Version 2.0 of your application is running on Kubernetes.
Congratulations! Version 2.0 of your application is running on Kubernetes.
Congratulations! Version 2.0 of your application is running on Kubernetes.
Congratulations! Version 2.0 of your application is running on Kubernetes.
Congratulations! Version 2.0 of your application is running on Kubernetes.
</div></code></code></pre>
<p>&quot;canary&quot; header is set to a value other than &quot;always&quot; - ingress falls back to routing based on weight and shoud route to the canary v2.0 in ~10% requests</p>
<pre><code><code><div>$ while true; do curl -H &quot;canary:somev&quot; localhost; echo ; sleep 1; done;
&gt; Congratulations! Version 1.0 of your application is running on Kubernetes.
&gt; Congratulations! Version 1.0 of your application is running on Kubernetes.
&gt; Congratulations! Version 1.0 of your application is running on Kubernetes.
&gt; Congratulations! Version 1.0 of your application is running on Kubernetes.
&gt; Congratulations! Version 1.0 of your application is running on Kubernetes.
&gt; Congratulations! Version 1.0 of your application is running on Kubernetes.
&gt; Congratulations! Version 1.0 of your application is running on Kubernetes.
&gt; Congratulations! Version 2.0 of your application is running on Kubernetes.
&gt; Congratulations! Version 1.0 of your application is running on Kubernetes.
&gt; Congratulations! Version 1.0 of your application is running on Kubernetes.
&gt; Congratulations! Version 1.0 of your application is running on Kubernetes.
&gt; Congratulations! Version 2.0 of your application is running on Kubernetes.
&gt; Congratulations! Version 1.0 of your application is running on Kubernetes.
</div></code></code></pre>

    </body>
    </html>